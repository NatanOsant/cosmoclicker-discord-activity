<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ—Å–º–æ–ö–ª–∏–∫–µ—Ä | –ó–∞—Ç—è–≥–∏–≤–∞—é—â–∏–π –∫–ª–∏–∫–µ—Ä</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0c0e2a, #1a1b3a);
            color: #e0e0ff;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            width: 100%;
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 30px;
            align-items: start;
        }

        /* –ü–∞–Ω–µ–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞) */
        .stats-panel, .upgrades-panel {
            background: rgba(30, 31, 60, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid #3a3b6a;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        }

        .stats-panel h2, .upgrades-panel h2 {
            color: #6ee7ff;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid #3a3b6a;
            padding-bottom: 10px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .stat-value {
            font-weight: bold;
            color: #a3ffd9;
            font-size: 1.1em;
        }

        /* –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∏–≥—Ä–æ–≤–∞—è –ø–∞–Ω–µ–ª—å */
        .game-center {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .title {
            color: #7b7cff;
            font-size: 2.8em;
            margin-bottom: 10px;
            text-shadow: 0 0 15px #7b7cff;
        }

        .subtitle {
            color: #b0b1ff;
            margin-bottom: 40px;
            font-size: 1.1em;
        }

        .click-counter {
            font-size: 4em;
            font-weight: bold;
            color: #ffffff;
            margin: 30px 0;
            text-shadow: 0 0 20px #00d9ff;
            min-height: 1.2em;
        }

        /* –ö–Ω–æ–ø–∫–∞ –∫–ª–∏–∫–∞ */
        .click-button {
            background: radial-gradient(circle, #ff5e7d, #ff375f);
            width: 280px;
            height: 280px;
            border-radius: 50%;
            border: none;
            color: white;
            font-size: 1.8em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.15s;
            box-shadow: 0 15px 35px rgba(255, 55, 95, 0.4),
                        inset 0 5px 20px rgba(255, 255, 255, 0.3);
            margin-bottom: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            user-select: none;
        }

        .click-button:hover {
            transform: scale(1.03);
        }

        .click-button:active {
            transform: scale(0.97);
            box-shadow: 0 5px 15px rgba(255, 55, 95, 0.6),
                        inset 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .click-button i {
            font-size: 4rem;
            margin-bottom: 10px;
        }

        .energy-bar-container {
            width: 90%;
            background: rgba(0, 0, 0, 0.4);
            height: 20px;
            border-radius: 10px;
            margin-top: 15px;
            overflow: hidden;
        }

        .energy-bar {
            height: 100%;
            background: linear-gradient(90deg, #00ffaa, #00ccff);
            width: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        /* –ü–∞–Ω–µ–ª—å —É–ª—É—á—à–µ–Ω–∏–π (–ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞) */
        .upgrade {
            background: rgba(40, 42, 80, 0.7);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #4a4c9a;
            transition: all 0.3s;
            cursor: pointer;
        }

        .upgrade:hover {
            background: rgba(50, 52, 100, 0.9);
            transform: translateY(-3px);
        }

        .upgrade-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .upgrade-name {
            font-weight: bold;
            color: #7b7cff;
        }

        .upgrade-cost {
            color: #ffb366;
            font-weight: bold;
        }

        .upgrade-desc {
            font-size: 0.9em;
            color: #b0b1ff;
            margin-bottom: 10px;
        }

        .upgrade-owned {
            color: #a3ffd9;
            font-size: 0.9em;
        }

        /* –ü—Å–µ–≤–¥–æ-–º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä */
        .multiplayer-panel {
            grid-column: 1 / -1;
            background: rgba(30, 31, 60, 0.8);
            border-radius: 20px;
            padding: 25px;
            margin-top: 20px;
            border: 1px solid #3a3b6a;
        }

        .leaderboard {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }

        .player {
            background: rgba(50, 52, 100, 0.6);
            padding: 15px;
            border-radius: 15px;
            min-width: 180px;
            text-align: center;
        }

        .player-name {
            font-weight: bold;
            color: #ffcc66;
        }

        .player-score {
            font-size: 1.5em;
            color: #ffffff;
            margin: 10px 0;
        }

        /* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–≤—É–∫–æ–º */
        .sound-control {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(30, 31, 60, 0.9);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 1px solid #3a3b6a;
            z-index: 100;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 900px) {
            .container {
                grid-template-columns: 1fr;
            }
            .click-button {
                width: 220px;
                height: 220px;
            }
        }
    </style>
</head>
<body>
    <!-- –ö–Ω–æ–ø–∫–∞ –∑–≤—É–∫–∞ (–¢–ï–ü–ï–†–¨ –û–ù–ê –†–ê–ë–û–¢–ê–ï–¢!) -->
    <div class="sound-control" id="soundToggle">
        <i class="fas fa-volume-up" id="soundIcon"></i>
    </div>

    <div class="container">
        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="stats-panel">
            <h2><i class="fas fa-chart-line"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
            <div class="stat-item">
                <span>–í—Å–µ–≥–æ –∫–ª–∏–∫–æ–≤:</span>
                <span class="stat-value" id="totalClicks">0</span>
            </div>
            <div class="stat-item">
                <span>–ö–ª–∏–∫–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É:</span>
                <span class="stat-value" id="clicksPerSecond">0</span>
            </div>
            <div class="stat-item">
                <span>–≠–Ω–µ—Ä–≥–∏—è:</span>
                <span class="stat-value" id="energyValue">100 / 100</span>
            </div>
            <div class="stat-item">
                <span>–°–∏–ª–∞ –∫–ª–∏–∫–∞:</span>
                <span class="stat-value" id="clickPower">1</span>
            </div>
            <div class="stat-item">
                <span>–í—Ä–µ–º—è –∏–≥—Ä—ã:</span>
                <span class="stat-value" id="playTime">00:00</span>
            </div>
        </div>

        <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å: –û—Å–Ω–æ–≤–Ω–∞—è –∏–≥—Ä–∞ -->
        <div class="game-center">
            <h1 class="title"><i class="fas fa-rocket"></i> –ö–æ—Å–º–æ–ö–ª–∏–∫–µ—Ä</h1>
            <p class="subtitle">–ö–ª–∏–∫–∞–π, —Ä–∞–∑–≤–∏–≤–∞–π—Å—è, —Å—Ç–∞–Ω—å –ª–∏–¥–µ—Ä–æ–º –≥–∞–ª–∞–∫—Ç–∏–∫–∏!</p>

            <div class="click-counter" id="clickCounter">0</div>

            <button class="click-button" id="clickButton">
                <i class="fas fa-fingerprint"></i>
                –ö–õ–ò–ö–ê–ô!
                <div class="energy-bar-container">
                    <div class="energy-bar" id="energyBar"></div>
                </div>
            </button>

            <p style="color:#b0b1ff; margin-top:20px;">–≠–Ω–µ—Ä–≥–∏—è –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º. –ü–æ–∫—É–ø–∞–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –¥–ª—è –∞–≤—Ç–æ-–∫–ª–∏–∫–æ–≤!</p>
        </div>

        <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –£–ª—É—á—à–µ–Ω–∏—è -->
        <div class="upgrades-panel">
            <h2><i class="fas fa-cogs"></i> –£–ª—É—á—à–µ–Ω–∏—è</h2>
            <div class="upgrade" id="upgradeClickPower">
                <div class="upgrade-header">
                    <span class="upgrade-name">–£—Å–∏–ª–∏—Ç–µ–ª—å –∫–ª–∏–∫–∞</span>
                    <span class="upgrade-cost" id="clickPowerCost">50</span>
                </div>
                <p class="upgrade-desc">–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å–∏–ª—É –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–∫–∞ –Ω–∞ +1.</p>
                <div class="upgrade-owned">–ö—É–ø–ª–µ–Ω–æ: <span id="clickPowerLevel">0</span></div>
            </div>
            <div class="upgrade" id="upgradeGenerator">
                <div class="upgrade-header">
                    <span class="upgrade-name">–ê–≤—Ç–æ-–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä</span>
                    <span class="upgrade-cost" id="generatorCost">100</span>
                </div>
                <p class="upgrade-desc">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–ª–∏–∫–∞–µ—Ç –∑–∞ –≤–∞—Å 1 —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É.</p>
                <div class="upgrade-owned">–ö—É–ø–ª–µ–Ω–æ: <span id="generatorCount">0</span></div>
            </div>
            <div class="upgrade" id="upgradeEnergy">
                <div class="upgrade-header">
                    <span class="upgrade-name">–ë–æ–ª—å—à–∞—è –±–∞—Ç–∞—Ä–µ—è</span>
                    <span class="upgrade-cost" id="energyCost">200</span>
                </div>
                <p class="upgrade-desc">–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —ç–Ω–µ—Ä–≥–∏—é –Ω–∞ 50.</p>
                <div class="upgrade-owned">–ö—É–ø–ª–µ–Ω–æ: <span id="energyLevel">0</span></div>
            </div>
        </div>

        <!-- –ü—Å–µ–≤–¥–æ-–º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä: –õ–∏–¥–µ—Ä–±–æ—Ä–¥ -->
        <div class="multiplayer-panel">
            <h2><i class="fas fa-trophy"></i> –ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–π—Ç–∏–Ω–≥</h2>
            <p style="color:#b0b1ff; margin-bottom:15px;">–°–æ—Ä–µ–≤–Ω—É–π—Å—è —Å –¥—Ä—É–≥–∏–º–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—è–º–∏ (–¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ).</p>
            <div class="leaderboard" id="leaderboard">
                <!-- –ò–≥—Ä–æ–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å–∫—Ä–∏–ø—Ç–æ–º -->
            </div>
        </div>
    </div>

    <!-- =============== –ó–í–£–ö–û–í–´–ï –§–ê–ô–õ–´ =============== -->
    <!-- –ó–í–£–ö: –í—Å–µ –∞—É–¥–∏–æ-—Ç–µ–≥–∏ –¥–ª—è –∑–≤—É–∫–æ–≤ –∏–≥—Ä—ã -->
    <!-- –¢—ã —Å–º–æ–∂–µ—à—å –∑–∞–º–µ–Ω–∏—Ç—å src –Ω–∞ —Å–≤–æ–∏ —Ñ–∞–π–ª—ã -->
    <audio id="clickSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3" type="audio/mpeg">
        <!-- –ó–í–£–ö: –û—Å–Ω–æ–≤–Ω–æ–π –∑–≤—É–∫ –∫–ª–∏–∫–∞ (–∫–æ—Ä–æ—Ç–∫–∏–π) -->
    </audio>
    <audio id="buySound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3" type="audio/mpeg">
        <!-- –ó–í–£–ö: –ü–æ–∫—É–ø–∫–∞ —É–ª—É—á—à–µ–Ω–∏—è (–ø—Ä–∏—è—Ç–Ω—ã–π "ding") -->
    </audio>
    <audio id="noEnergySound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3" type="audio/mpeg">
        <!-- –ó–í–£–ö: –ù–µ—Ç —ç–Ω–µ—Ä–≥–∏–∏ (–Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π –∑–≤—É–∫) -->
    </audio>
    <audio id="energyFullSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3" type="audio/mpeg">
        <!-- –ó–í–£–ö: –≠–Ω–µ—Ä–≥–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ (–ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π) -->
    </audio>
    <audio id="generatorSound" preload="auto" volume="0.3">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-sci-fi-robot-notification-895.mp3" type="audio/mpeg">
        <!-- –ó–í–£–ö: –†–∞–±–æ—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ (–º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–π –∑–≤—É–∫) -->
    </audio>
    <audio id="bgMusic" preload="auto" loop volume="0.2">
        <source src="https://assets.mixkit.co/music/preview/mixkit-game-show-suspense-waiting-667.mp3" type="audio/mpeg">
        <!-- –ó–í–£–ö: –§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞ (ambient) -->
    </audio>

    <script>
        // ================== –°–û–°–¢–û–Ø–ù–ò–ï –ò–ì–†–´ ==================
        const gameState = {
            clicks: 0,
            totalClicks: 0,
            clickPower: 1,
            clickPowerLevel: 0,
            energy: 100,
            maxEnergy: 100,
            energyLevel: 0,
            generators: 0,
            clicksPerSecond: 0,
            playTimeSeconds: 0,
            soundOn: true
        };

        // –¶–µ–Ω—ã —É–ª—É—á—à–µ–Ω–∏–π (—Ä–∞—Å—Ç—É—Ç)
        const upgradeCosts = {
            clickPower: 50,
            generator: 100,
            energy: 200
        };

        // ================== –ó–í–£–ö–ò ==================
        // –ó–í–£–ö: –û–±—ä–µ–∫—Ç —Å–æ –≤—Å–µ–º–∏ –∑–≤—É–∫–æ–≤—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
        const sounds = {
            click: document.getElementById('clickSound'),
            buy: document.getElementById('buySound'),
            noEnergy: document.getElementById('noEnergySound'),
            energyFull: document.getElementById('energyFullSound'),
            generator: document.getElementById('generatorSound'),
            background: document.getElementById('bgMusic')
        };

        // –ó–í–£–ö: –§–ª–∞–≥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ–ª–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏
        let wasEnergyFull = true;
        // –ó–í–£–ö: –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–≤—É–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
        let lastGeneratorSound = 0;

        // ================== –≠–õ–ï–ú–ï–ù–¢–´ –î–û–ú ==================
        const clickCounterEl = document.getElementById('clickCounter');
        const totalClicksEl = document.getElementById('totalClicks');
        const clicksPerSecondEl = document.getElementById('clicksPerSecond');
        const energyValueEl = document.getElementById('energyValue');
        const energyBarEl = document.getElementById('energyBar');
        const clickPowerEl = document.getElementById('clickPower');
        const playTimeEl = document.getElementById('playTime');

        const clickButton = document.getElementById('clickButton');
        const clickPowerUpgrade = document.getElementById('upgradeClickPower');
        const generatorUpgrade = document.getElementById('upgradeGenerator');
        const energyUpgrade = document.getElementById('upgradeEnergy');

        const clickPowerCostEl = document.getElementById('clickPowerCost');
        const generatorCostEl = document.getElementById('generatorCost');
        const energyCostEl = document.getElementById('energyCost');

        const clickPowerLevelEl = document.getElementById('clickPowerLevel');
        const generatorCountEl = document.getElementById('generatorCount');
        const energyLevelEl = document.getElementById('energyLevel');

        const soundToggle = document.getElementById('soundToggle');
        const soundIcon = document.getElementById('soundIcon');

        const leaderboardEl = document.getElementById('leaderboard');

        // ================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==================
        function init() {
            loadGame();
            updateUI();
            setupEventListeners();
            startGameLoop();
            updateLeaderboard();
            setInterval(updateLeaderboard, 30000);
            
            // –ó–í–£–ö: –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –º—É–∑—ã–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –µ—Å–ª–∏ –∑–≤—É–∫ –≤–∫–ª—é—á–µ–Ω
            if (gameState.soundOn) {
                sounds.background.volume = 0.2;
                sounds.background.play().catch(e => {
                    console.log("–ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∑–≤—É–∫–∞.");
                    // –ó–í–£–ö: –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–∫–∞ –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∞—É–¥–∏–æ
                    document.addEventListener('click', function startAudio() {
                        if (gameState.soundOn) {
                            sounds.background.play();
                        }
                        document.removeEventListener('click', startAudio);
                    }, { once: true });
                });
            }
        }

        // ================== –û–°–ù–û–í–ù–û–ô –ì–ï–ô–ú–ü–õ–ï–ô ==================
        function click() {
            // –ó–í–£–ö: –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–Ω–µ—Ä–≥–∏–∏ –ø–µ—Ä–µ–¥ –∫–ª–∏–∫–æ–º
            if (gameState.energy <= 0) {
                if (gameState.soundOn) {
                    sounds.noEnergy.currentTime = 0;
                    sounds.noEnergy.play();
                }
                return;
            }

            gameState.clicks += gameState.clickPower;
            gameState.totalClicks += gameState.clickPower;
            gameState.energy -= 2;

            // –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ—Ç–¥–∞—á–∞
            clickButton.style.transform = 'scale(0.97)';
            setTimeout(() => { clickButton.style.transform = 'scale(1)'; }, 150);

            // –°–æ–∑–¥–∞–µ–º –ª–µ—Ç—è—â—É—é —Ü–∏—Ñ—Ä—É
            createFlyingNumber(gameState.clickPower);

            // –ó–í–£–ö: –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ –∫–ª–∏–∫–∞
            if (gameState.soundOn) {
                sounds.click.currentTime = 0;
                sounds.click.play();
            }

            updateUI();
            saveGame();
        }

        // ================== –£–õ–£–ß–®–ï–ù–ò–Ø ==================
        function buyUpgrade(type) {
            let cost = upgradeCosts[type];
            if (gameState.clicks < cost) return;

            gameState.clicks -= cost;

            switch (type) {
                case 'clickPower':
                    gameState.clickPower += 1;
                    gameState.clickPowerLevel += 1;
                    upgradeCosts.clickPower = Math.floor(50 * Math.pow(1.5, gameState.clickPowerLevel));
                    break;
                case 'generator':
                    gameState.generators += 1;
                    upgradeCosts.generator = Math.floor(100 * Math.pow(1.8, gameState.generators));
                    break;
                case 'energy':
                    gameState.maxEnergy += 50;
                    gameState.energy = gameState.maxEnergy;
                    gameState.energyLevel += 1;
                    upgradeCosts.energy = Math.floor(200 * Math.pow(1.6, gameState.energyLevel));
                    break;
            }

            // –ó–í–£–ö: –ó–≤—É–∫ –ø–æ–∫—É–ø–∫–∏ —É–ª—É—á—à–µ–Ω–∏—è
            if (gameState.soundOn) {
                sounds.buy.currentTime = 0;
                sounds.buy.play();
            }

            updateUI();
            saveGame();
        }

        // ================== –ò–ì–†–û–í–û–ô –¶–ò–ö–õ ==================
        function startGameLoop() {
            setInterval(() => {
                // –ê–≤—Ç–æ-–∫–ª–∏–∫–∏ –æ—Ç –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤
                if (gameState.generators > 0) {
                    const autoClicks = gameState.generators;
                    gameState.clicks += autoClicks;
                    gameState.totalClicks += autoClicks;
                }

                // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏
                if (gameState.energy < gameState.maxEnergy) {
                    gameState.energy = Math.min(gameState.maxEnergy, gameState.energy + 5);
                    
                    // –ó–í–£–ö: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–Ω–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏
                    if (gameState.energy >= gameState.maxEnergy && !wasEnergyFull) {
                        wasEnergyFull = true;
                        if (gameState.soundOn) {
                            sounds.energyFull.currentTime = 0;
                            sounds.energyFull.play();
                        }
                    }
                } else if (gameState.energy < gameState.maxEnergy) {
                    wasEnergyFull = false;
                }

                // –ó–í–£–ö: –°–ª—É—á–∞–π–Ω—ã–µ –∑–≤—É–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
                if (gameState.generators > 0 && gameState.energy < gameState.maxEnergy && gameState.soundOn) {
                    const now = Date.now();
                    // –ó–≤—É–∫ –∫–∞–∂–¥—ã–µ 2-5 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∫–∞–∂–¥—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
                    if (now - lastGeneratorSound > 2000 + Math.random() * 3000) {
                        sounds.generator.currentTime = 0;
                        sounds.generator.volume = 0.2 + (Math.random() * 0.3);
                        sounds.generator.play();
                        lastGeneratorSound = now;
                    }
                }

                // –†–∞—Å—á–µ—Ç –∫–ª–∏–∫–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
                gameState.clicksPerSecond = gameState.generators;

                // –í—Ä–µ–º—è –∏–≥—Ä—ã
                gameState.playTimeSeconds++;

                updateUI();
            }, 1000);
        }

        // ================== –ü–°–ï–í–î–û-–ú–£–õ–¨–¢–ò–ü–õ–ï–ï–† ==================
        function updateLeaderboard() {
            let players = JSON.parse(localStorage.getItem('cosmoClicker_players')) || [];

            if (players.length < 5) {
                const botNames = ['–ö–æ—Å–º–æ–Ω–∞–≤—Ç_–ê–ª–µ–∫—Å', '–ó–≤–µ–∑–¥–æ—á—ë—Ç', '–ì–∞–ª–∞–∫—Ç–∏–∫–∞_–•', '–†–æ–±–æ—Ç_–ö–ª–∏–∫–µ—Ä', '–ù–æ–≤–∏—á–æ–∫_2024', '–ü—Ä–æ_–ò–≥—Ä–æ–∫', '–ò–Ω–æ–ø–ª–∞–Ω–µ—Ç—è–Ω–∏–Ω'];
                for (let i = players.length; i < 5; i++) {
                    players.push({
                        name: botNames[i],
                        score: Math.floor(Math.random() * 10000) + 1000,
                        isBot: true
                    });
                }
            }

            const currentPlayer = {
                name: '–í—ã',
                score: gameState.totalClicks,
                isBot: false
            };
            
            const existingIndex = players.findIndex(p => p.name === '–í—ã');
            if (existingIndex >= 0) {
                players[existingIndex] = currentPlayer;
            } else {
                players.push(currentPlayer);
            }

            players.sort((a, b) => b.score - a.score);
            players = players.slice(0, 7);

            localStorage.setItem('cosmoClicker_players', JSON.stringify(players));
            renderLeaderboard(players);
        }

        function renderLeaderboard(players) {
            leaderboardEl.innerHTML = '';
            players.forEach(player => {
                const playerEl = document.createElement('div');
                playerEl.className = 'player';
                playerEl.innerHTML = `
                    <div class="player-name">${player.name} ${player.isBot ? 'ü§ñ' : 'üë§'}</div>
                    <div class="player-score">${formatNumber(player.score)}</div>
                    <div style="color:#b0b1ff; font-size:0.8em;">–í—Å–µ–≥–æ –∫–ª–∏–∫–æ–≤</div>
                `;
                if (player.name === '–í—ã') {
                    playerEl.style.border = '2px solid #6ee7ff';
                    playerEl.style.background = 'rgba(110, 231, 255, 0.1)';
                }
                leaderboardEl.appendChild(playerEl);
            });
        }

        // ================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==================
        function createFlyingNumber(value) {
            const flyingNumber = document.createElement('div');
            flyingNumber.textContent = '+' + value;
            flyingNumber.style.position = 'absolute';
            flyingNumber.style.color = '#a3ffd9';
            flyingNumber.style.fontWeight = 'bold';
            flyingNumber.style.fontSize = '1.5em';
            flyingNumber.style.pointerEvents = 'none';
            flyingNumber.style.zIndex = '1000';
            flyingNumber.style.left = '50%';
            flyingNumber.style.top = '50%';
            flyingNumber.style.transform = 'translate(-50%, -50%)';

            clickButton.appendChild(flyingNumber);

            let pos = 50;
            const flyInterval = setInterval(() => {
                pos -= 1;
                flyingNumber.style.top = pos + '%';
                flyingNumber.style.opacity = (pos - 30) / 20;
                if (pos <= 30) {
                    clearInterval(flyInterval);
                    flyingNumber.remove();
                }
            }, 20);
        }

        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return Math.floor(num).toString();
        }

        function updateUI() {
            clickCounterEl.textContent = formatNumber(gameState.clicks);
            totalClicksEl.textContent = formatNumber(gameState.totalClicks);
            clicksPerSecondEl.textContent = gameState.clicksPerSecond + '/—Å–µ–∫';
            clickPowerEl.textContent = gameState.clickPower;
            energyValueEl.textContent = Math.floor(gameState.energy) + ' / ' + gameState.maxEnergy;
            energyBarEl.style.width = (gameState.energy / gameState.maxEnergy * 100) + '%';

            clickPowerCostEl.textContent = formatNumber(upgradeCosts.clickPower);
            generatorCostEl.textContent = formatNumber(upgradeCosts.generator);
            energyCostEl.textContent = formatNumber(upgradeCosts.energy);

            clickPowerLevelEl.textContent = gameState.clickPowerLevel;
            generatorCountEl.textContent = gameState.generators;
            energyLevelEl.textContent = gameState.energyLevel;

            const minutes = Math.floor(gameState.playTimeSeconds / 60);
            const seconds = gameState.playTimeSeconds % 60;
            playTimeEl.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

            clickButton.style.opacity = gameState.energy > 0 ? '1' : '0.7';

            const upgrades = [
                { el: clickPowerUpgrade, cost: upgradeCosts.clickPower },
                { el: generatorUpgrade, cost: upgradeCosts.generator },
                { el: energyUpgrade, cost: upgradeCosts.energy }
            ];
            upgrades.forEach(upg => {
                if (gameState.clicks >= upg.cost) {
                    upg.el.style.boxShadow = '0 0 15px #6ee7ff';
                } else {
                    upg.el.style.boxShadow = 'none';
                }
            });
        }

        function setupEventListeners() {
            clickButton.addEventListener('click', click);
            clickPowerUpgrade.addEventListener('click', () => buyUpgrade('clickPower'));
            generatorUpgrade.addEventListener('click', () => buyUpgrade('generator'));
            energyUpgrade.addEventListener('click', () => buyUpgrade('energy'));

            // –ó–í–£–ö: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–≤—É–∫–æ–º —Å –º—É–∑—ã–∫–æ–π
            soundToggle.addEventListener('click', () => {
                gameState.soundOn = !gameState.soundOn;
                soundIcon.className = gameState.soundOn ? 'fas fa-volume-up' : 'fas fa-volume-mute';
                
                if (gameState.soundOn) {
                    // –í–∫–ª—é—á–∞–µ–º –≤—Å–µ –∑–≤—É–∫–∏
                    sounds.background.play().catch(e => console.log("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –º—É–∑—ã–∫—É"));
                } else {
                    // –í—ã–∫–ª—é—á–∞–µ–º –≤—Å–µ –∑–≤—É–∫–∏
                    sounds.background.pause();
                    sounds.background.currentTime = 0;
                }
                
                localStorage.setItem('cosmoClicker_sound', gameState.soundOn);
            });

            window.addEventListener('beforeunload', saveGame);
        }

        // ================== –°–û–•–†–ê–ù–ï–ù–ò–ï / –ó–ê–ì–†–£–ó–ö–ê ==================
        function saveGame() {
            const saveData = {
                ...gameState,
                upgradeCosts: upgradeCosts
            };
            localStorage.setItem('cosmoClicker_save', JSON.stringify(saveData));
            localStorage.setItem('cosmoClicker_sound', gameState.soundOn);
        }

        function loadGame() {
            const saved = JSON.parse(localStorage.getItem('cosmoClicker_save'));
            const savedSound = localStorage.getItem('cosmoClicker_sound');
            if (saved) {
                Object.assign(gameState, saved);
                if (saved.upgradeCosts) Object.assign(upgradeCosts, saved.upgradeCosts);
            }
            if (savedSound !== null) {
                gameState.soundOn = savedSound === 'true';
                soundIcon.className = gameState.soundOn ? 'fas fa-volume-up' : 'fas fa-volume-mute';
            }
        }

        // ================== –ó–ê–ü–£–°–ö ==================
        window.onload = init;
    </script>
</body>
</html>
